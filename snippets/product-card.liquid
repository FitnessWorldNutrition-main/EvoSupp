{%- liquid
	assign products_hover_images = settings.products_hover_images
	assign product_aspect_ratio = settings.product_aspect_ratio
	assign product_content_alignment = settings.product_content_alignment
	assign featured_media = product_card_product.featured_media
	assign product_price_position = settings.product_price_position
	assign ratio = 1
	assign sizes = '298x298,596x596'
	assign info_spacing = true
	assign product_card_border = settings.product_card_border
	assign product_card_shadow = settings.product_card_shadow
	assign product_card_shadow_class = 'has-shadow--' | append: product_card_shadow

	if featured_media.media_type != 'image'
		assign featured_media = featured_media.preview_image
	endif

	if product_aspect_ratio == 'adapt'
		assign ratio = featured_media.aspect_ratio
		assign sizes = '298x0,596x0'
	elsif product_aspect_ratio == 'portrait'
		assign ratio = 1 | divided_by: 1.25
		assign sizes = '298x350,596x700'
	elsif product_aspect_ratio == 'landscape'
		assign ratio = 1 | divided_by: 0.75
		assign sizes = '298x250,596x500'
	endif

	assign color_body_bg = settings.color_body_bg | downcase
	assign color_product_card_bg = settings.color_product_card_bg | downcase

	if color_body_bg == color_product_card_bg or color_product_card_bg == 'transparent' or color_product_card_bg == 'rgba(0,0,0,0)'
		unless product_card_border
			assign info_spacing = false
		endunless
		if product_card_shadow
			assign info_spacing = true
		endif
	endif

	assign is_purchasable = false
	if product_card_product.available and product_card_product.variants.size == 1
		assign is_purchasable = true
	endif
-%}
{%- if product_card_product and product_card_product != empty -%}
<product-card class="product-card text-{{ product_content_alignment }} product-card--content-spacing-{{ info_spacing }} product-card--border-{{ product_card_border }} {{ product_card_shadow_class }}">
  <figure class="product-featured-image {% if products_hover_images and product_card_product.images.size > 1 %}thb-hover{% endif %}">
    {% render 'product-card-badge', product_card_product: product_card_product %}
		{% render 'product-card-compare', product_card_product: product_card_product %}
    <a href="{{ product_card_product.url | within: collection }}" title="{{ product_card_product.title | escape }}" class="product-featured-image-link aspect-ratio aspect-ratio--{{ settings.product_aspect_ratio }}" style="--padding-bottom: {{ 1 | divided_by: ratio | times: 100 }}%;">
      {%- if products_hover_images and product_card_product.images.size > 1 -%}
        {%- render 'responsive-image', class: 'product-secondary-image', image: product_card_product.images[1], sizes: sizes -%}
      {%- endif -%}
			{%- if featured_media -%}
      	{%- render 'responsive-image', class: 'product-primary-image', image: featured_media, sizes: sizes -%}
			{%- else -%}
				<div class="thb-placeholder">
					{{ 'product-apparel-1' | placeholder_svg_tag }}
				</div>
			{%- endif -%}

			{%- if settings.enable_quick_view -%}
			<quick-view class="product-card-quickview" data-product-handle="{{ product_card_product.handle }}" tabindex="-1">
				<div class="loading-overlay">{% render 'svg-icons' with 'thb-loading' %}</div>
				<span>{{ 'products.product.quick_view' | t }}</span>
			</quick-view>
			{%- endif -%}
    </a>
		{%- if settings.enable_quick_add -%}
			{%- liquid
				assign button_tag = 'button'
				if product_card_product.selected_or_first_available_variant.available == false
					assign button_content = 'products.product.sold_out' | t
				else
					if is_purchasable
							assign button_content = 'products.product.add_to_cart' | t
					else
						assign button_tag = 'quick-view'
						assign button_content = 'products.product.choose_options' | t
					endif
					if product_card_product.metafields.theme.preorder and product_card_product.available
						assign button_content = 'products.product.pre_order' | t
					endif
				endif
			-%}
			{%- comment -%} Cart Conditions: Build incompatible products list {%- endcomment -%}
			{%- assign tabs_produits_incompatibles = "" -%}
			{%- for produit in product_card_product.metafields.custom.produits_incompatibles.value -%}
				{%- if forloop.first == false -%}
					{%- assign tabs_produits_incompatibles = tabs_produits_incompatibles | append: "," -%}
				{%- endif -%}
				{%- assign tabs_produits_incompatibles = tabs_produits_incompatibles | append: produit.id -%}
			{%- endfor -%}
			<div class="product-card--add-to-cart-button-wrapper" style="--cart-button-bg: {{ settings.quick_add_button_bg }}; --cart-icon-color: {{ settings.quick_add_button_icon_color }};">
				<{{ button_tag }} class="product-card--add-to-cart-button{% if is_purchasable %} product-card--add-to-cart-button-simple{% endif %}" data-product-id="{{ product_card_product.selected_or_first_available_variant.id }}" data-product-handle="{{ product_card_product.handle }}" {% if product_card_product.metafields.custom.max_quantity.value != blank %}data-max-quantity="{{ product_card_product.metafields.custom.max_quantity.value }}"{% else %}data-max-quantity="none"{% endif %} {% if tabs_produits_incompatibles != blank %}data-incompatible-products="{{ tabs_produits_incompatibles }}"{% endif %} tabindex="-1" {% if product_card_product.selected_or_first_available_variant.available == false %}disabled{% endif %}>
					{% render 'svg-icons' with 'thb-loading' %}
					<svg width="24" height="20" viewBox="0 0 24 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="product-card--cart-icon">
						<path d="M10.974 17.9841C10.974 19.0977 10.0716 20 8.95805 20C7.84447 20 6.94214 19.0977 6.94214 17.9841C6.94214 16.8705 7.84447 15.9682 8.95805 15.9682C10.0716 15.9682 10.974 16.8705 10.974 17.9841Z" fill="currentColor"/>
						<path d="M19.1436 17.9841C19.1436 19.0977 18.2413 20 17.1277 20C16.0141 20 15.1118 19.0977 15.1118 17.9841C15.1118 16.8705 16.0141 15.9682 17.1277 15.9682C18.2413 15.9682 19.1436 16.8705 19.1436 17.9841Z" fill="currentColor"/>
						<path d="M22.0614 3.12997H9.51503V5.25199H20.7352L19.462 10.6631C19.3843 11.0141 19.1896 11.3286 18.9102 11.555C18.6307 11.7815 18.283 11.9065 17.9235 11.9098H9.22325C8.859 11.9122 8.50518 11.79 8.22003 11.5631C7.93536 11.3362 7.73689 11.0184 7.65826 10.6631L5.43015 0.822281C5.37615 0.588291 5.24447 0.379879 5.05643 0.230674C4.86885 0.0809966 4.63581 0 4.39566 0H0.947388V2.12202H3.54686L5.5893 11.1406C5.77166 11.9662 6.23206 12.7037 6.89377 13.2304C7.55548 13.7566 8.37776 14.0399 9.22325 14.0323H17.9235C18.7643 14.0342 19.5804 13.7481 20.2369 13.2223C20.8934 12.6966 21.3495 11.9619 21.5309 11.1411L23.0959 4.43018C23.1689 4.11519 23.0936 3.78363 22.8923 3.53069C22.6909 3.27776 22.385 3.12997 22.0614 3.12997Z" fill="currentColor"/>
					</svg>
				</{{ button_tag }}>
			</div>
		{%- endif -%}
  </figure>
	<div class="product-card-info">
		{%- if settings.show_products_vendor -%}
		<div class="product-card-vendor"><a href="{{ product_card_product.vendor | url_for_vendor }}" title="{{ product_card_product.vendor | escape }}">{{ product_card_product.vendor }}</a></div>
		{%- endif -%}
		{%- liquid
			if product_price_position == 'before-product-title'
				render 'product-price', product: product_card_product
			endif
		-%}
  	<a href="{{ product_card_product.url | within: collection }}" title="{{ product_card_product.title | escape }}" class="product-card-title">{{ product_card_product.title }}</a>
		{%- liquid
			if product_price_position == 'after-product-title'
				render 'product-price', product: product_card_product
			endif
		-%}
		{%- unless compare_table -%}
		{% render 'product-card-swatch', product: product_card_product, sizes: sizes %}
		{%- endunless -%}
		{%- if settings.show_products_rating and product_card_product.metafields.reviews.rating.value != blank -%}
		<div class="star-rating" style="--star-rating: {{ product_card_product.metafields.reviews.rating.value.rating }};">{%- if settings.show_products_rating_average %}<span class="body-font">{{ product_card_product.metafields.reviews.rating.value.rating | round: 2 }}</span>{%- endif -%}</div>
		{%- endif -%}
		{%- render 'product-card-inventory-notice', product: product_card_product -%}
		{%- unless compare_table -%}
		{%- render 'product-card-labels', product: product_card_product -%}
		{%- endunless -%}
		{%- if settings.show_products_subtitle and product_card_product.metafields.descriptors.subtitle != blank -%}
			<p class="product-card-subtitle">{{ product_card_product.metafields.descriptors.subtitle }}</p>
		{%- endif -%}
  </div>
</product-card>
{%- else -%}
<product-card class="product-card text-{{ product_content_alignment }} product-card--content-spacing-{{ info_spacing }} product-card--border-{{ product_card_border }} {{ product_card_shadow_class }}">
	<figure class="product-featured-image {% if settings.products_hover_images %}thb-hover{% endif %}">
		<a href="{{ product_card_product.url | within: collection }}" title="{{ product_card_product.title | escape }}" class="product-featured-image-link aspect-ratio aspect-ratio--{{ settings.product_aspect_ratio }}" style="--padding-bottom: {{ 1 | divided_by: 1 | times: 100 }}%;">
			<div class="thb-placeholder">
				{{ 'product-apparel-1' | placeholder_svg_tag }}
			</div>
			<quick-view class="product-card-quickview" data-product-handle="{{ product_card_product.handle }}" tabindex="-1">
				<div class="loading-overlay">{% render 'svg-icons' with 'thb-loading' %}</div>
				<span>{{ 'products.product.quick_view' | t }}</span>
			</quick-view>
		</a>
		{%- if settings.enable_quick_add -%}
		<div class="product-card--add-to-cart-button-wrapper" style="--cart-button-bg: {{ settings.quick_add_button_bg }}; --cart-icon-color: {{ settings.quick_add_button_icon_color }};">
			<quick-view class="product-card--add-to-cart-button" data-product-handle="" tabindex="-1">
				{% render 'svg-icons' with 'thb-loading' %}
				<svg width="24" height="20" viewBox="0 0 24 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="product-card--cart-icon">
					<path d="M10.974 17.9841C10.974 19.0977 10.0716 20 8.95805 20C7.84447 20 6.94214 19.0977 6.94214 17.9841C6.94214 16.8705 7.84447 15.9682 8.95805 15.9682C10.0716 15.9682 10.974 16.8705 10.974 17.9841Z" fill="currentColor"/>
					<path d="M19.1436 17.9841C19.1436 19.0977 18.2413 20 17.1277 20C16.0141 20 15.1118 19.0977 15.1118 17.9841C15.1118 16.8705 16.0141 15.9682 17.1277 15.9682C18.2413 15.9682 19.1436 16.8705 19.1436 17.9841Z" fill="currentColor"/>
					<path d="M22.0614 3.12997H9.51503V5.25199H20.7352L19.462 10.6631C19.3843 11.0141 19.1896 11.3286 18.9102 11.555C18.6307 11.7815 18.283 11.9065 17.9235 11.9098H9.22325C8.859 11.9122 8.50518 11.79 8.22003 11.5631C7.93536 11.3362 7.73689 11.0184 7.65826 10.6631L5.43015 0.822281C5.37615 0.588291 5.24447 0.379879 5.05643 0.230674C4.86885 0.0809966 4.63581 0 4.39566 0H0.947388V2.12202H3.54686L5.5893 11.1406C5.77166 11.9662 6.23206 12.7037 6.89377 13.2304C7.55548 13.7566 8.37776 14.0399 9.22325 14.0323H17.9235C18.7643 14.0342 19.5804 13.7481 20.2369 13.2223C20.8934 12.6966 21.3495 11.9619 21.5309 11.1411L23.0959 4.43018C23.1689 4.11519 23.0936 3.78363 22.8923 3.53069C22.6909 3.27776 22.385 3.12997 22.0614 3.12997Z" fill="currentColor"/>
				</svg>
			</quick-view>
		</div>
		{%- endif -%}
	</figure>
	<div class="product-card-info">
		<div class="product-card-vendor"><a href="#" title="{{ 'onboarding.product_vendor' | t }}">{{ 'onboarding.product_vendor' | t }}</a></div>
		{%- liquid
			if product_price_position == 'before-product-title'
				render 'product-price', product: product_card_product
			endif
		-%}
		<a href="#" title="{{ product_card_product.title | escape }}" class="product-card-title">{{ 'onboarding.product_title' | t }}</a>
		{%- liquid
			if product_price_position == 'after-product-title'
				render 'product-price', product: product_card_product
			endif
		-%}
		{%- if settings.show_products_rating and product_card_product.metafields.reviews.rating.value != blank -%}
		<div class="star-rating" style="--star-rating: 5;"><span class="body-font">5</span></div>
		{%- endif -%}
	</div>
</product-card>
{%- endif -%}
